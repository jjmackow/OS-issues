!function(t,e){"use strict";"function"==typeof define&&define.amd?define([window.dBlazy],e):"object"==typeof exports?module.exports=e(window.dBlazy):t.Bio=e(window.dBlazy)}(this,function(t){"use strict";function e(t){var e=this,i={root:null,disconnect:!1,error:!1,success:!1,observing:!1,successClass:"b-loaded",selector:".b-lazy",errorClass:"b-error",bgClass:"b-bg",rootMargin:"0px",threshold:[0]};e.opts=r.extend({},i,t||{}),e.opts.selector=e.opts.selector+":not(."+e.opts.successClass+")",e.elms=(e.opts.root||n).querySelectorAll(e.opts.selector),e.count=e.elms.length,e.counted=0,e._er=-1,e._ok=1,e.windowWidth=o.innerWidth||n.documentElement.clientWidth||n.body.clientWidth||o.screen.width,e.prepare(),s(e)}function s(t){var e={rootMargin:t.opts.rootMargin,threshold:t.opts.threshold};t.instance=new IntersectionObserver(function(e,s){t.observing(e,s)},e),t.observe(!1)}var o=window,n=document,r=t,i=0,c=0;"IntersectionObserver"in o&&"IntersectionObserverEntry"in o&&"intersectionRatio"in o.IntersectionObserverEntry.prototype&&!("isIntersecting"in IntersectionObserverEntry.prototype)&&Object.defineProperty(o.IntersectionObserverEntry.prototype,"isIntersecting",{get:function(){return this.intersectionRatio>0}});var a=e.prototype;return a.constructor=e,a.load=function(t){var e=this;e.isValid(t)?e.intersecting(t):r.forEach(t,function(t){e.isValid(t)&&e.intersecting(t)})},a.isValid=function(t){return"object"==typeof t&&void 0===t.length&&!t.classList.contains(this.opts.successClass)},a.prepare=function(){},a.revalidate=function(t){var e=this;(void 0===t&&e.count!==e.counted||!0===t)&&c<e.counted&&(e.observe(!0),c++)},a.intersecting=function(t){var e=this;e.lazyLoad(t),e.observer.unobserve(t),e.counted++},a.lazyLoad=function(t){},a.success=function(t){var e=this;"function"==typeof e.opts.success&&e.opts.success(t,e.opts)},a.error=function(t){var e=this;"function"==typeof e.opts.error&&e.opts.error(t,e.opts)},a.loaded=function(t,e){var s=this;s[e===s._ok?"success":"error"](t),t.classList.add(e===s._ok?s.opts.successClass:s.opts.errorClass)},a.removeAttrs=function(t,e){r.forEach(e,function(e){t.removeAttribute("data-"+e)})},a.setAttrs=function(t,e,s,o){var n=this;r.forEach(e,function(e){n.setAttr(t,e,s,o)})},a.setAttr=function(t,e,s,o){t.hasAttribute("data-"+e)&&(t.setAttribute(e,t.getAttribute("data-"+e)),void 0!==s&&(s.src=t.getAttribute(o)))},a.equal=function(t,e){return t.nodeName.toLowerCase()===e},a.observe=function(t){var e=this;i=e.elms.length,r.forEach(e.elms,function(s){s.classList.contains(e.opts.successClass)&&!0!==t||e.instance.observe(s)})},a.observing=function(t,e){var s=this;s.entries=t,s.observer=e,r.forEach(t,function(t){"function"==typeof s.opts.observing&&s.opts.observing(t,e,s.opts),t.isIntersecting&&(t.target.classList.contains(s.opts.successClass)||s.intersecting(t.target),i--)}),0!==i&&s.count!==s.counted||!s.opts.disconnect||e.disconnect()},e});
